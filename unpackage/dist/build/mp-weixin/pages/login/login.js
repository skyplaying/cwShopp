(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"0495":function(e,t,o){"use strict";o.r(t);var n=o("3388"),s=o.n(n);for(var i in n)"default"!==i&&function(e){o.d(t,e,function(){return n[e]})}(i);t["default"]=s.a},"1e2d":function(e,t,o){"use strict";o.r(t);var n=o("6b95"),s=o("0495");for(var i in s)"default"!==i&&function(e){o.d(t,e,function(){return s[e]})}(i);o("4226");var c=o("2877"),u=Object(c["a"])(s["default"],n["a"],n["b"],!1,null,null,null);t["default"]=u.exports},3388:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,s=function(){return o.e("components/uni-popup/uni-popup").then(o.bind(null,"ce60"))},i={data:function(){return{isok:!0,isSubmit:!1,isShenhe:!1,isMask:!1,isAuth:!1,timeShow:!0,count:"",timer:null,userName:"",phone:"",authCode:"",isRegist:!1,userCode:"",userInfo:"",islogin:!1,encryptedData:"",encryptedSecret:"",iv:""}},onLoad:function(){n=this,n.isShowAuthPop(),n.loginForCode()},onShow:function(){},components:{uniPopup:s},methods:{openPop:function(){this.$refs.authPop.open()},toCheckIngPage:function(){this.isRegist||this.isShenhe||e.navigateTo({url:"../auditAccount/auditAccount"})},loginForCode:function(){e.login({success:function(t){console.log(t),n.userCode=t.code,console.log(n.userCode),e.getUserInfo({success:function(e){console.log(e),n.userInfo=e.userInfo,n.encryptedData=e.encryptedData,n.iv=e.iv,n.loginAuth()}})}})},getLoginCode:function(){e.login({success:function(t){n.userCode=t.code,console.log(n.userCode),e.getUserInfo({success:function(e){console.log(e),n.userInfo=e.userInfo,n.encryptedData=e.encryptedData,n.iv=e.iv}})}})},signInSubmit:function(){var t=n.checkName();n.userInfo;e.login({success:function(o){console.log(o),n.userCode=o.code,console.log(n.userCode),e.getUserInfo({success:function(o){console.log(o),n.userInfo=o.userInfo,n.encryptedData=o.encryptedData,n.iv=o.iv,t&&n.$http.request({url:"/api/auth/wechatServicerUserRegister",data:{code:n.userCode,realName:n.userName,phoneNumber:n.phone,verificationCode:n.authCode,encryptedData:n.encryptedData,encryptedSecret:n.iv},success:function(t){console.log(t),1e5==t.data.code&&(n.isRegist=!0,e.showToast({title:"注册成功",success:function(){}}),e.navigateTo({url:"../auditAccount/auditAccount"}))}})}})}})},queryShopAuditStatus:function(){},loginSubmit:function(){var t=this.$api.checkPhone(n.phone);n.userInfo;t?n.authCode?n.authCode&&e.login({success:function(t){n.userCode=t.code,console.log(n.userCode),e.getUserInfo({success:function(t){console.log(t),n.userInfo=t.userInfo,n.encryptedData=t.encryptedData,n.iv=t.iv,n.$http.request({url:"/api/auth/wechatServicerUserLogin",data:{code:n.userCode,phoneNumber:n.phone,verificationCode:n.authCode,encryptedData:n.encryptedData,encryptedSecret:n.iv},success:function(t){console.log("登录",t.data),1e5==t.data.code?(e.setStorageSync("user",t.data.servicerUserInfo),e.setStorageSync("userId",t.data.servicerUserInfo.servicerUserId),e.showToast({title:"登录成功"}),1==t.data.servicerUserInfo.servicerState?e.navigateTo({url:"../auditAccount/auditAccount"}):2==t.data.servicerUserInfo.servicerState?e.navigateTo({url:"../shop/shopAddIndex/shopAddIndex"}):3==t.data.servicerUserInfo.servicerState&&e.navigateTo({url:"../shop/storeAudit/storeAudit"})):e.showToast({title:t.msg})}})}})}}):e.showToast({icon:"none",title:"验证码为空"}):e.showToast({icon:"none",title:"手机号不正确"})},checkName:function(){var t=this.$api.checkChinaName(n.userName),o=this.$api.checkPhone(n.phone);if(t){if(o)return t=t&&o&&n.authCode,t;e.showToast({title:"手机号不正确",icon:"none"})}else e.showToast({title:"姓名输入有误",icon:"none"})},loginAuth:function(){n.$http.request({url:"/api/auth/wechatServicerUserAuthAndIsServicerUser",data:{code:n.userCode,encryptedData:n.encryptedData,encryptedSecret:n.iv}}).then(function(t){1e5==t.data.code&&(1==t.data.isServicerUser?n.isRegist=!0:0==t.data.isServicerUser&&(n.isRegist=!1),n.isok=!0,e.hideLoading())})},getAuthCode:function(){var e=n.$api.checkPhone(n.phone);e&&n.phone&&(this.getCode(),n.$http.request({url:"/api/sendSms/sendVerificationCode",data:{phoneNumber:n.phone},success:function(e){}}))},isShowAuthPop:function(){e.getUserInfo({success:function(e){n.userInfo=e.userInfo,e.userInfo?n.isAuth=!0:n.isAuth=!1}})},takePhone:function(){e.makePhoneCall({phoneNumber:16368111120,success:function(e){},fail:function(e){}})},sureAuth:function(){e.getUserInfo({success:function(e){console.log(e),e.userInfo&&(n.isMask=!1,n.isAuth=!0)}})},getCode:function(){var e=this,t=60;this.timer||(this.count=t,this.timeShow=!1,this.timer=setInterval(function(){e.count>0&&e.count<=t?e.count--:(e.show=!0,clearInterval(e.timer),e.timer=null)},1e3))}}};t.default=i}).call(this,o("543d")["default"])},4226:function(e,t,o){"use strict";var n=o("c8b9"),s=o.n(n);s.a},"6b95":function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},s=[];o.d(t,"a",function(){return n}),o.d(t,"b",function(){return s})},c8b9:function(e,t,o){}},[["dd8c","common/runtime","common/vendor"]]]);